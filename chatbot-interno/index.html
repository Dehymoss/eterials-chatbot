<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Interno - Eterials</title>
    <script>
        // Funci√≥n para obtener el n√∫mero de mesa desde la URL
        function obtenerNumeroMesa() {
            let params = new URLSearchParams(window.location.search);
            return params.get("mesa") || "Sin n√∫mero";
        }

        // Funci√≥n para mostrar el saludo con n√∫mero de mesa y nombre
        function mostrarSaludo() {
            let numeroMesa = obtenerNumeroMesa();
            let nombreCliente = localStorage.getItem("nombreCliente") || "Invitado";

            document.getElementById("saludo").innerHTML = `¬°Hola, ${nombreCliente}! Est√°s en la mesa ${numeroMesa}.`;
        }

        // Guardar el nombre del cliente en localStorage
        function guardarNombre() {
            let nombre = document.getElementById("nombre").value;
            localStorage.setItem("nombreCliente", nombre);
            mostrarSaludo();
            reiniciarInactividad(); // Reiniciar el temporizador cuando se guarda el nombre
        }

        // Guardar calificaci√≥n del usuario
        function guardarCalificacion(valor) {
            localStorage.setItem("calificacionUsuario", valor);
            alert("¬°Gracias por tu calificaci√≥n!");
        }

        // Guardar comentario del usuario
        function guardarComentario() {
            let comentario = document.getElementById("comentarios").value;
            if (comentario.trim() !== "") {
                localStorage.setItem("comentarioUsuario", comentario);
                alert("¬°Gracias por tu comentario!");
                document.getElementById("comentarios").value = "";
            }
        }

        // Sistema de inactividad con vibraci√≥n
        let inactividadTimer;

        function reiniciarInactividad() {
            clearTimeout(inactividadTimer);
            inactividadTimer = setTimeout(preguntarAntesDeCerrar, 180000);
        }

        function preguntarAntesDeCerrar() {
            if ("vibrate" in navigator) {
                navigator.vibrate([200, 100, 200]); // Vibraci√≥n para captar atenci√≥n
            }
            let respuesta = confirm("¬øDeseas seguir en la sesi√≥n o finalizar?");
            if (!respuesta) cerrarSesion();
            else reiniciarInactividad(); // Si el usuario sigue, reinicia el temporizador
        }

        function cerrarSesion() {
            alert("Sesi√≥n finalizada.");
            window.location.href = "https://dehymoss.github.io/eterials-chatbot/";
        }

        // Detectar actividad del usuario y reiniciar el temporizador
        document.addEventListener("mousemove", reiniciarInactividad);
        document.addEventListener("keydown", reiniciarInactividad);

        window.onload = function() {
            mostrarSaludo();
            reiniciarInactividad(); // Iniciar detecci√≥n de inactividad al cargar
        };
    </script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .boton { padding: 10px 20px; margin: 5px; background-color: #6A0DAD; color: white; border: none; cursor: pointer; }
        .feedback-container { margin-top: 20px; }
        .comentarios-container { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Bienvenido al Asistente de Mesa</h1>
    <h2 id="saludo">Cargando...</h2>
    
    <p>Ingresa tu nombre para personalizar tu experiencia:</p>
    <input type="text" id="nombre" placeholder="Escribe tu nombre">
    <button class="boton" onclick="guardarNombre()">Guardar Nombre</button>

    <h3>Selecciona una opci√≥n:</h3>
    <button class="boton" onclick="location.href='menu.html'">üìú Men√∫</button>
    <button class="boton" onclick="location.href='cancionero.html'">üé∂ Cancionero</button>
    <button class="boton" onclick="location.href='mesero.html'">üßë‚Äçüç≥ Llamar al mesero</button>
    <button class="boton" onclick="location.href='galeria.html'">üñºÔ∏è Galer√≠a</button>
    <button class="boton" onclick="location.href='eventos.html'">üìÖ Pr√≥ximos eventos</button>
    <button class="boton" onclick="location.href='karaoke.html'">üé§ Karaoke</button>

    <div class="feedback-container">
        <h3>‚≠ê Calif√≠canos:</h3>
        <button class="boton" onclick="guardarCalificacion(1)">1 ‚≠ê</button>
        <button class="boton" onclick="guardarCalificacion(2)">2 ‚≠ê</button>
        <button class="boton" onclick="guardarCalificacion(3)">3 ‚≠ê</button>
        <button class="boton" onclick="guardarCalificacion(4)">4 ‚≠ê</button>
        <button class="boton" onclick="guardarCalificacion(5)">5 ‚≠ê</button>
    </div>

    <div class="comentarios-container">
        <h3>‚úçÔ∏è D√©janos tus comentarios:</h3>
        <textarea id="comentarios" rows="4" cols="40" placeholder="Escribe aqu√≠ tu comentario..."></textarea><br>
        <button class="boton" onclick="guardarComentario()">Enviar</button>
    </div>
</body>
</html>